import{h as m,T as re,j as H,q as M,k as oe,o as i,f as c,a as O,u as b,w as Y,F as C,Z as ae,b as e,d as a,n as _,g as y,t as n,v as A,E as ne,C as q,l as $,H as P,I as de}from"./app-D8wmBy9s.js";import{_ as le}from"./AuthenticatedLayout-BNaGA4LG.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./ThemeToggle-B3tLVrVv.js";const ie={class:"flex justify-between items-center"},ce=e("h2",{class:"font-semibold text-xl text-gray-800 dark:text-gray-200 leading-tight"}," NSTP Status Management ",-1),ue={class:"flex space-x-2"},ge=e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})],-1),pe={class:"py-6"},he={class:"max-w-7xl mx-auto sm:px-6 lg:px-8"},me={class:"bg-white dark:bg-gray-800 overflow-hidden shadow-sm sm:rounded-lg mb-6"},xe=e("h3",{class:"text-lg font-medium text-purple-800 dark:text-purple-300"},"NSTP Status Management Instructions",-1),fe=e("path",{"fill-rule":"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z","clip-rule":"evenodd"},null,-1),be=[fe],_e={key:0,class:"p-6 text-gray-700 dark:text-gray-300"},ye=e("ul",{class:"list-disc list-inside space-y-2"},[e("li",null,"Use this page to manage students' NSTP 1 and NSTP 2 completion status."),e("li",null,[a("Switch between "),e("span",{class:"font-semibold"},"NSTP 1"),a(" and "),e("span",{class:"font-semibold"},"NSTP 2"),a(" tabs to manage each semester separately.")]),e("li",null,[a("The dashboard at the top shows the current statistics for "),e("span",{class:"font-semibold"},"Pending"),a(", "),e("span",{class:"font-semibold"},"Passed"),a(", and "),e("span",{class:"font-semibold"},"Failed"),a(" students.")]),e("li",null,[a("Use the "),e("span",{class:"font-semibold"},"Mark Students as Failed"),a(" button to select students who did not complete the requirements.")]),e("li",null,[a("Use the "),e("span",{class:"font-semibold"},"Submit & Process"),a(" button to mark selected students as failed and all other pending students as passed.")]),e("li",null,"Filter the student list using the search box, course dropdown, or school year selection."),e("li",null,"Changes to NSTP status will affect students' eligibility for certificate generation."),e("li",null,[a("Use "),e("span",{class:"font-semibold"},"Reset All to Pending"),a(" to clear all status values and start fresh for a semester.")])],-1),ve=[ye],we={key:1,class:"p-4 mb-4 rounded-md shadow-sm bg-amber-50 text-amber-700 dark:bg-amber-900 dark:text-amber-200 flex justify-between items-center"},ke=e("span",{class:"font-bold"},"Filtered view:",-1),Se={class:"bg-white dark:bg-gray-800 shadow-sm sm:rounded-lg overflow-hidden"},Ce={class:"border-b border-gray-200 dark:border-gray-700"},Pe={class:"-mb-px flex"},Ne={id:"nstp1",class:"p-6 hidden"},Fe={class:"flex flex-wrap gap-2 mb-6"},Te={class:"px-4 py-2 bg-yellow-50 dark:bg-yellow-900 text-yellow-700 dark:text-yellow-300 rounded-lg shadow-sm"},Ae=e("span",{class:"font-semibold"},"Pending:",-1),$e={class:"px-4 py-2 bg-green-50 dark:bg-green-900 text-green-700 dark:text-green-300 rounded-lg shadow-sm"},je=e("span",{class:"font-semibold"},"Passed:",-1),Me={class:"px-4 py-2 bg-red-50 dark:bg-red-900 text-red-700 dark:text-red-300 rounded-lg shadow-sm"},Le=e("span",{class:"font-semibold"},"Failed:",-1),Ee={key:0,class:"px-4 py-2 bg-purple-50 dark:bg-purple-900 text-purple-700 dark:text-purple-300 rounded-lg shadow-sm"},Ie=e("span",{class:"font-semibold"},"Selected for Fail:",-1),Be={class:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6"},De={class:"bg-white dark:bg-gray-700 p-4 rounded-lg shadow-sm border border-gray-200 dark:border-gray-600"},Ue=e("h4",{class:"text-sm font-semibold text-gray-700 dark:text-gray-300 mb-3"},"Student Selection",-1),ze={class:"space-y-2"},Ve=e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})],-1),Re=["disabled"],He=e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})],-1),Oe={class:"bg-white dark:bg-gray-700 p-4 rounded-lg shadow-sm border border-gray-200 dark:border-gray-600"},Ye=e("h4",{class:"text-sm font-semibold text-gray-700 dark:text-gray-300 mb-3"},"Process Changes",-1),qe={class:"space-y-2"},Ge=e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"})],-1),We=e("p",{class:"text-xs text-gray-500 dark:text-gray-400 mt-1"}," Marks selected students as failed, all other pending students as passed. ",-1),Ze={class:"bg-white dark:bg-gray-700 p-4 rounded-lg shadow-sm border border-gray-200 dark:border-gray-600"},Je=e("h4",{class:"text-sm font-semibold text-gray-700 dark:text-gray-300 mb-3"},"Advanced Actions",-1),Ke={class:"space-y-2"},Qe=["disabled"],Xe=e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})],-1),et=e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})],-1),tt={id:"nstp2",class:"p-6 hidden"},st={class:"flex flex-wrap gap-2 mb-6"},rt={class:"px-4 py-2 bg-yellow-50 dark:bg-yellow-900 text-yellow-700 dark:text-yellow-300 rounded-lg shadow-sm"},ot=e("span",{class:"font-semibold"},"Pending:",-1),at={class:"px-4 py-2 bg-green-50 dark:bg-green-900 text-green-700 dark:text-green-300 rounded-lg shadow-sm"},nt=e("span",{class:"font-semibold"},"Passed:",-1),dt={class:"px-4 py-2 bg-red-50 dark:bg-red-900 text-red-700 dark:text-red-300 rounded-lg shadow-sm"},lt=e("span",{class:"font-semibold"},"Failed:",-1),it={key:0,class:"px-4 py-2 bg-purple-50 dark:bg-purple-900 text-purple-700 dark:text-purple-300 rounded-lg shadow-sm"},ct=e("span",{class:"font-semibold"},"Selected for Fail:",-1),ut={class:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6"},gt={class:"bg-white dark:bg-gray-700 p-4 rounded-lg shadow-sm border border-gray-200 dark:border-gray-600"},pt=e("h4",{class:"text-sm font-semibold text-gray-700 dark:text-gray-300 mb-3"},"Student Selection",-1),ht={class:"space-y-2"},mt=e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})],-1),xt=["disabled"],ft=e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})],-1),bt={class:"bg-white dark:bg-gray-700 p-4 rounded-lg shadow-sm border border-gray-200 dark:border-gray-600"},_t=e("h4",{class:"text-sm font-semibold text-gray-700 dark:text-gray-300 mb-3"},"Process Changes",-1),yt={class:"space-y-2"},vt=e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"})],-1),wt=e("p",{class:"text-xs text-gray-500 dark:text-gray-400 mt-1"}," Marks selected students as failed, all other pending students as passed. ",-1),kt={class:"bg-white dark:bg-gray-700 p-4 rounded-lg shadow-sm border border-gray-200 dark:border-gray-600"},St=e("h4",{class:"text-sm font-semibold text-gray-700 dark:text-gray-300 mb-3"},"Advanced Actions",-1),Ct={class:"space-y-2"},Pt=["disabled"],Nt=e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})],-1),Ft=e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})],-1),Tt={key:0},At={class:"fixed inset-0 flex items-center justify-center z-50"},$t={class:"bg-white dark:bg-gray-800 rounded-lg p-6 max-w-4xl w-full max-h-[80vh] overflow-y-auto"},jt={class:"flex justify-between items-center mb-4"},Mt={class:"text-xl font-semibold text-gray-800 dark:text-gray-200"},Lt=e("svg",{class:"h-6 w-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1),Et=[Lt],It={class:"mb-6 grid grid-cols-1 md:grid-cols-3 gap-4"},Bt=e("label",{for:"search",class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},"Search",-1),Dt=e("label",{for:"course_id",class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},"Course",-1),Ut=e("option",{value:""},"All Courses",-1),zt=["value"],Vt=e("label",{for:"school_year",class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},"School Year",-1),Rt=e("option",{value:""},"All Years",-1),Ht=["value"],Ot={class:"overflow-x-auto"},Yt={class:"w-full divide-y divide-gray-200 dark:divide-gray-700"},qt={class:"bg-gray-50 dark:bg-gray-700"},Gt={scope:"col",class:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"},Wt=e("th",{scope:"col",class:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"}," Student ID ",-1),Zt=e("th",{scope:"col",class:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"}," Name ",-1),Jt=e("th",{scope:"col",class:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"}," Course ",-1),Kt=e("th",{scope:"col",class:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"}," Status ",-1),Qt={class:"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700"},Xt={class:"px-4 py-3 whitespace-nowrap"},es=["value"],ts={class:"px-4 py-3 whitespace-nowrap text-xs text-gray-900 dark:text-gray-300"},ss=["title"],rs={class:"px-4 py-3 whitespace-nowrap text-sm text-gray-900 dark:text-gray-300"},os={class:"px-4 py-3 whitespace-nowrap"},as={key:0},ns={colspan:"5",class:"px-4 py-6 text-center text-gray-500 dark:text-gray-400"},ds={class:"flex justify-end mt-6 space-x-3"},ls=["disabled"],is=e("div",{class:"fixed inset-0 bg-black opacity-50"},null,-1),cs={key:1},us={class:"fixed inset-0 flex items-center justify-center z-50"},gs={class:"bg-white dark:bg-gray-800 rounded-lg p-6 max-w-4xl w-full max-h-[80vh] overflow-y-auto"},ps={class:"flex justify-between items-center mb-4"},hs={class:"text-xl font-semibold text-gray-800 dark:text-gray-200"},ms=e("svg",{class:"h-6 w-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1),xs=[ms],fs={class:"overflow-x-auto"},bs={class:"w-full divide-y divide-gray-200 dark:divide-gray-700"},_s=e("thead",{class:"bg-gray-50 dark:bg-gray-700"},[e("tr",null,[e("th",{scope:"col",class:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"}," Student ID "),e("th",{scope:"col",class:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"}," Name "),e("th",{scope:"col",class:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"}," Course "),e("th",{scope:"col",class:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"}," Status "),e("th",{scope:"col",class:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"}," Action ")])],-1),ys={class:"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700"},vs={class:"px-4 py-3 whitespace-nowrap text-xs text-gray-900 dark:text-gray-300"},ws=["title"],ks={class:"px-4 py-3 whitespace-nowrap text-sm text-gray-900 dark:text-gray-300"},Ss={class:"px-4 py-3 whitespace-nowrap"},Cs=e("span",{class:"ml-2 px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200"}," Will be marked as Failed ",-1),Ps={class:"px-4 py-3 whitespace-nowrap"},Ns=["onClick"],Fs={key:0},Ts=e("td",{colspan:"5",class:"px-4 py-6 text-center text-gray-500 dark:text-gray-400"},' No students selected to fail. Click "Add Students" to select students. ',-1),As=[Ts],$s={class:"flex justify-end mt-6 space-x-3"},js=e("div",{class:"fixed inset-0 bg-black opacity-50"},null,-1),Bs={__name:"NstpStatus",props:{students:{type:Array,default:()=>[]},courses:{type:Array,default:()=>[]},graduationYears:{type:Array,default:()=>[]},stats:{type:Object,default:()=>({nstp1:{pending:0,passed:0,failed:0},nstp2:{pending:0,passed:0,failed:0}})},flash:{type:Object,default:()=>({})},showFailedFilter:{type:Boolean,default:!1},failedFilter:{type:String,default:""}},setup(G){const o=G,N=m(""),F=m(""),T=m(!1),L=m("nstp1"),E=t=>{L.value=t,document.getElementById("nstp1").classList.add("hidden"),document.getElementById("nstp2").classList.add("hidden"),document.getElementById(t).classList.remove("hidden"),document.querySelectorAll(".tab-link").forEach(s=>{s.getAttribute("href")===`#${t}`?(s.classList.add("border-blue-500","text-blue-600","dark:text-blue-300"),s.classList.remove("border-transparent","text-gray-500")):(s.classList.remove("border-blue-500","text-blue-600","dark:text-blue-300"),s.classList.add("border-transparent","text-gray-500"))})},x=(t,r="success")=>{N.value=t,F.value=r,setTimeout(()=>{N.value="",F.value=""},5e3)};o.flash&&o.flash.success?x(o.flash.success,"success"):o.flash&&o.flash.error&&x(o.flash.error,"error");const g=m([]),p=m([]),w=m(!1),S=m(!1),h=m("nstp1"),d=re({search:"",course_id:"",school_year:""}),f=m([]),v=m([]);H(()=>o.students.filter(t=>t.first_sem_status===2)),H(()=>o.students.filter(t=>t.second_sem_status===2));const I=()=>h.value==="nstp1"?g.value.map(t=>o.students.find(r=>r.id===t)).filter(t=>t!==void 0):p.value.map(t=>o.students.find(r=>r.id===t)).filter(t=>t!==void 0),j=()=>{if(!d.search&&!d.course_id&&!d.school_year){v.value=[];return}v.value=o.students.filter(t=>{var R;if(o.showFailedFilter){if(!(o.failedFilter==="nstp1"?t.first_sem_status===0:t.second_sem_status===0))return!1}else if(!(h.value==="nstp1"?t.first_sem_status===2:t.second_sem_status===2))return!1;const r=`${t.last_name}, ${t.first_name} ${t.middle_name}`.toLowerCase(),s=((R=t.student_id)==null?void 0:R.toLowerCase())||"",u=d.search===""||r.includes(d.search.toLowerCase())||s.includes(d.search.toLowerCase()),l=d.course_id===""||t.course&&t.course.id.toString()===d.course_id,k=d.school_year===""||t.enrollment_year===d.school_year;return u&&l&&k}),console.log(`Found ${v.value.length} students that match the criteria for ${h.value}`),h.value==="nstp1"?g.value=g.value.filter(t=>{const r=o.students.find(s=>s.id===t);return r&&(o.showFailedFilter?r.first_sem_status===0:r.first_sem_status===2)}):p.value=p.value.filter(t=>{const r=o.students.find(s=>s.id===t);return r&&(o.showFailedFilter?r.second_sem_status===0:r.second_sem_status===2)})},B=t=>{h.value=t,w.value=!0,f.value=[],d.search="",d.course_id="",d.school_year="",v.value=[];const s=o.students.filter(u=>t==="nstp1"?u.first_sem_status===2:u.second_sem_status===2).length;console.log(`Opening modal to select failed students. There are ${s} pending students for NSTP ${t==="nstp1"?"1":"2"}`),s===0&&(x(`There are no pending students for NSTP ${t==="nstp1"?"1":"2"}. All students have already been marked as passed or failed.`,"error"),w.value=!1)},D=t=>{h.value=t,S.value=!0},W=()=>{if(f.value.length===0){alert("Please select at least one student to add.");return}const t=f.value.map(r=>parseInt(r,10));console.log("Selected IDs to add:",t),h.value==="nstp1"?(g.value=[...new Set([...g.value,...t])],console.log("Updated NSTP1 failed students:",g.value)):(p.value=[...new Set([...p.value,...t])],console.log("Updated NSTP2 failed students:",p.value)),w.value=!1,f.value=[]},Z=t=>{h.value==="nstp1"?g.value=g.value.filter(r=>r!==t):p.value=p.value.filter(r=>r!==t)},U=t=>{const r=t==="nstp1"?g.value:p.value;if(console.log(`Submitting ${t} with student IDs:`,r),r.length===0){if(!confirm(`No students are marked as failed. This will mark ALL pending students as PASSED for NSTP ${t==="nstp1"?"1":"2"}. Continue?`))return;P.post(route(t==="nstp1"?"nstp1.submit":"nstp2.submit")).then(u=>{console.log("Submit successful, updating UI..."),o.students.forEach(l=>{t==="nstp1"&&l.first_sem_status===2?l.first_sem_status=1:t==="nstp2"&&l.second_sem_status===2&&(l.second_sem_status=1)}),t==="nstp1"?(o.stats.nstp1.passed+=o.stats.nstp1.pending,o.stats.nstp1.pending=0):(o.stats.nstp2.passed+=o.stats.nstp2.pending,o.stats.nstp2.pending=0),x(`All pending students have been marked as PASSED for NSTP ${t==="nstp1"?"1":"2"}.`,"success")}).catch(u=>{console.error("Error submitting NSTP status:",u),x("An error occurred while updating student statuses. Please try again.","error")});return}if(!confirm(`This will mark ${r.length} students as FAILED and all remaining pending students as PASSED for NSTP ${t==="nstp1"?"1":"2"}. Continue?`))return;const s={student_ids:r};console.log("Submitting form data:",s),P.post(route(t==="nstp1"?"nstp1.failed":"nstp2.failed"),s).then(u=>{console.log("First step successful, submitting second step..."),o.students.forEach(l=>{r.includes(l.id)&&(t==="nstp1"?l.first_sem_status=0:l.second_sem_status=0)}),P.post(route(t==="nstp1"?"nstp1.submit":"nstp2.submit")).then(l=>{console.log("Both steps successful, updating UI..."),o.students.forEach(k=>{t==="nstp1"&&k.first_sem_status===2?k.first_sem_status=1:t==="nstp2"&&k.second_sem_status===2&&(k.second_sem_status=1)}),t==="nstp1"?(o.stats.nstp1.failed+=r.length,o.stats.nstp1.passed+=o.stats.nstp1.pending-r.length,o.stats.nstp1.pending=0):(o.stats.nstp2.failed+=r.length,o.stats.nstp2.passed+=o.stats.nstp2.pending-r.length,o.stats.nstp2.pending=0),x(`${r.length} students marked as FAILED and all remaining pending students marked as PASSED for NSTP ${t==="nstp1"?"1":"2"}.`,"success"),t==="nstp1"?g.value=[]:p.value=[],S.value=!1}).catch(l=>{console.error("Error submitting NSTP status (pass step):",l),x("An error occurred while marking remaining students as passed. Please try again.","error")})}).catch(u=>{console.error("Error submitting NSTP status (fail step):",u),x("An error occurred while marking selected students as failed. Please try again.","error")})};M(()=>d.search,()=>{(d.search.length>=2||d.search==="")&&j()}),M(()=>d.course_id,()=>{j()}),M(()=>d.school_year,()=>{j()});const z=t=>{if(t==null)return"bg-gray-100 text-gray-800 dark:bg-gray-900 dark:text-gray-200";switch(parseInt(t,10)){case 1:return"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200";case 0:return"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200";case 2:default:return"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200"}},V=t=>{if(t==null)return"Unknown";switch(parseInt(t,10)){case 1:return"Passed";case 0:return"Failed";case 2:return"Pending";default:return"Unknown"}},J=()=>{confirm("Are you sure you want to reset ALL students to PENDING status for NSTP 1? This action cannot be undone.")&&P.post(route("nstp1.reset.all")).then(t=>{console.log("Reset NSTP1 successful"),window.location.reload()}).catch(t=>{console.error("Error resetting NSTP1 status:",t),x("An error occurred while resetting student statuses. Please try again.","error")})},K=()=>{confirm("Are you sure you want to reset ALL students to PENDING status for NSTP 2? This action cannot be undone.")&&P.post(route("nstp2.reset.all")).then(t=>{console.log("Reset NSTP2 successful"),window.location.reload()}).catch(t=>{console.error("Error resetting NSTP2 status:",t),x("An error occurred while resetting student statuses. Please try again.","error")})},Q=()=>{window.location.href=route("nstp1.failed.list")},X=()=>{window.location.href=route("nstp2.failed.list")},ee=()=>{window.location.href=route("nstp.status")},te=()=>{var t,r;if(o.showFailedFilter){const s=o.failedFilter;(t=document.getElementById(s))==null||t.classList.remove("hidden"),L.value=s,setTimeout(()=>{document.querySelectorAll(".tab-link").forEach(l=>{l.getAttribute("href")===`#${s}`?(l.classList.add("border-blue-500","text-blue-600","dark:text-blue-300"),l.classList.remove("border-transparent","text-gray-500")):(l.classList.remove("border-blue-500","text-blue-600","dark:text-blue-300"),l.classList.add("border-transparent","text-gray-500"))})},0)}else(r=document.getElementById("nstp1"))==null||r.classList.remove("hidden")};return oe(()=>{te()}),(t,r)=>(i(),c(C,null,[O(b(ae),{title:"NSTP Status Management"}),O(le,null,{header:Y(()=>[e("div",ie,[ce,e("div",ue,[e("button",{onClick:r[0]||(r[0]=s=>t.window.location.reload()),class:"px-3 py-1.5 bg-gray-500 hover:bg-gray-700 text-white text-sm rounded flex items-center"},[ge,a(" Refresh Data ")])])])]),default:Y(()=>[e("div",pe,[e("div",he,[e("div",me,[e("div",{onClick:r[1]||(r[1]=s=>T.value=!T.value),class:"p-4 border-b border-gray-200 dark:border-gray-700 bg-purple-50 dark:bg-purple-900/20 cursor-pointer flex justify-between items-center"},[xe,(i(),c("svg",{class:_(["h-5 w-5 text-purple-600 dark:text-purple-400 transform transition-transform duration-200",{"rotate-180":T.value}]),xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor"},be,2))]),T.value?(i(),c("div",_e,ve)):y("",!0)]),N.value?(i(),c("div",{key:0,class:_([{"bg-green-100 dark:bg-green-900/20 border-green-400 dark:border-green-800 text-green-700 dark:text-green-300":F.value==="success","bg-red-100 dark:bg-red-900/20 border-red-400 dark:border-red-800 text-red-700 dark:text-red-300":F.value==="error"},"mb-6 p-4 border-l-4 rounded"])},n(N.value),3)):y("",!0),o.showFailedFilter?(i(),c("div",we,[e("div",null,[ke,a(" Showing only failed students for NSTP "+n(o.failedFilter==="nstp1"?"1":"2"),1)]),e("button",{onClick:ee,class:"px-2 py-1 bg-amber-200 hover:bg-amber-300 dark:bg-amber-800 dark:hover:bg-amber-700 text-amber-800 dark:text-amber-200 rounded text-sm"}," Clear Filter ")])):y("",!0),e("div",Se,[e("div",Ce,[e("nav",Pe,[e("a",{href:"#nstp1",class:"border-blue-500 text-blue-600 dark:text-blue-300 whitespace-nowrap py-4 px-6 border-b-2 font-medium text-sm tab-link",onClick:r[2]||(r[2]=s=>E("nstp1"))}," NSTP 1 "),e("a",{href:"#nstp2",class:"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 whitespace-nowrap py-4 px-6 border-b-2 font-medium text-sm tab-link",onClick:r[3]||(r[3]=s=>E("nstp2"))}," NSTP 2 ")])]),e("div",Ne,[e("div",Fe,[e("div",Te,[Ae,a(" "+n(o.stats.nstp1.pending),1)]),e("div",$e,[je,a(" "+n(o.stats.nstp1.passed),1)]),e("div",Me,[Le,a(" "+n(o.stats.nstp1.failed),1)]),g.value.length>0?(i(),c("div",Ee,[Ie,a(" "+n(g.value.length),1)])):y("",!0)]),e("div",Be,[e("div",De,[Ue,e("div",ze,[e("button",{onClick:r[4]||(r[4]=s=>B("nstp1")),class:"w-full py-2 px-3 bg-blue-500 hover:bg-blue-700 text-white rounded text-sm flex items-center justify-center"},[Ve,a(" Add Students to Failed List ")]),e("button",{onClick:r[5]||(r[5]=s=>D("nstp1")),class:_(["w-full py-2 px-3 bg-indigo-500 hover:bg-indigo-700 text-white rounded text-sm flex items-center justify-center",{"opacity-50 cursor-not-allowed":g.value.length===0}]),disabled:g.value.length===0},[He,a(" View Selected ("+n(g.value.length)+") ",1)],10,Re)])]),e("div",Oe,[Ye,e("div",qe,[e("button",{onClick:r[6]||(r[6]=s=>U("nstp1")),class:"w-full py-2 px-3 bg-green-500 hover:bg-green-700 text-white rounded text-sm flex items-center justify-center"},[Ge,a(" Submit & Process Students ")]),We])]),e("div",Ze,[Je,e("div",Ke,[e("button",{onClick:Q,class:_(["w-full py-2 px-3 bg-amber-500 hover:bg-amber-700 text-white rounded text-sm flex items-center justify-center",{"opacity-50 cursor-not-allowed":o.stats.nstp1.failed===0}]),disabled:o.stats.nstp1.failed===0},[Xe,a(" View Failed ("+n(o.stats.nstp1.failed)+") ",1)],10,Qe),e("button",{onClick:J,class:"w-full py-2 px-3 bg-orange-500 hover:bg-orange-700 text-white rounded text-sm flex items-center justify-center"},[et,a(" Reset All to Pending ")])])])])]),e("div",tt,[e("div",st,[e("div",rt,[ot,a(" "+n(o.stats.nstp2.pending),1)]),e("div",at,[nt,a(" "+n(o.stats.nstp2.passed),1)]),e("div",dt,[lt,a(" "+n(o.stats.nstp2.failed),1)]),p.value.length>0?(i(),c("div",it,[ct,a(" "+n(p.value.length),1)])):y("",!0)]),e("div",ut,[e("div",gt,[pt,e("div",ht,[e("button",{onClick:r[7]||(r[7]=s=>B("nstp2")),class:"w-full py-2 px-3 bg-blue-500 hover:bg-blue-700 text-white rounded text-sm flex items-center justify-center"},[mt,a(" Add Students to Failed List ")]),e("button",{onClick:r[8]||(r[8]=s=>D("nstp2")),class:_(["w-full py-2 px-3 bg-indigo-500 hover:bg-indigo-700 text-white rounded text-sm flex items-center justify-center",{"opacity-50 cursor-not-allowed":p.value.length===0}]),disabled:p.value.length===0},[ft,a(" View Selected ("+n(p.value.length)+") ",1)],10,xt)])]),e("div",bt,[_t,e("div",yt,[e("button",{onClick:r[9]||(r[9]=s=>U("nstp2")),class:"w-full py-2 px-3 bg-green-500 hover:bg-green-700 text-white rounded text-sm flex items-center justify-center"},[vt,a(" Submit & Process Students ")]),wt])]),e("div",kt,[St,e("div",Ct,[e("button",{onClick:X,class:_(["w-full py-2 px-3 bg-amber-500 hover:bg-amber-700 text-white rounded text-sm flex items-center justify-center",{"opacity-50 cursor-not-allowed":o.stats.nstp2.failed===0}]),disabled:o.stats.nstp2.failed===0},[Nt,a(" View Failed ("+n(o.stats.nstp2.failed)+") ",1)],10,Pt),e("button",{onClick:K,class:"w-full py-2 px-3 bg-orange-500 hover:bg-orange-700 text-white rounded text-sm flex items-center justify-center"},[Ft,a(" Reset All to Pending ")])])])])])])])]),w.value?(i(),c("div",Tt,[e("div",At,[e("div",$t,[e("div",jt,[e("h2",Mt," Add Students to Failed List (NSTP "+n(h.value==="nstp1"?"1":"2")+") ",1),e("button",{onClick:r[10]||(r[10]=s=>w.value=!1),class:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 focus:outline-none"},Et)]),e("div",It,[e("div",null,[Bt,A(e("input",{id:"search","onUpdate:modelValue":r[11]||(r[11]=s=>b(d).search=s),type:"text",class:"border-gray-300 dark:border-gray-700 dark:bg-gray-900 dark:text-gray-300 focus:border-indigo-500 focus:ring-indigo-500 rounded-md shadow-sm block w-full",placeholder:"Name or Student ID"},null,512),[[ne,b(d).search]])]),e("div",null,[Dt,A(e("select",{id:"course_id","onUpdate:modelValue":r[12]||(r[12]=s=>b(d).course_id=s),class:"border-gray-300 dark:border-gray-700 dark:bg-gray-900 dark:text-gray-300 focus:border-indigo-500 focus:ring-indigo-500 rounded-md shadow-sm block w-full"},[Ut,(i(!0),c(C,null,$(o.courses,s=>(i(),c("option",{value:s.id,key:s.id},n(s.name),9,zt))),128))],512),[[q,b(d).course_id]])]),e("div",null,[Vt,A(e("select",{id:"school_year","onUpdate:modelValue":r[13]||(r[13]=s=>b(d).school_year=s),class:"border-gray-300 dark:border-gray-700 dark:bg-gray-900 dark:text-gray-300 focus:border-indigo-500 focus:ring-indigo-500 rounded-md shadow-sm block w-full"},[Rt,(i(!0),c(C,null,$(o.graduationYears,s=>(i(),c("option",{value:s,key:s},n(s),9,Ht))),128))],512),[[q,b(d).school_year]])])]),e("div",Ot,[e("table",Yt,[e("thead",qt,[e("tr",null,[e("th",Gt,[e("input",{type:"checkbox",class:"form-checkbox h-4 w-4 text-blue-500 dark:text-blue-400 rounded dark:bg-gray-700 dark:border-gray-600",onChange:r[14]||(r[14]=s=>f.value=s.target.checked?v.value.map(u=>u.id):[])},null,32)]),Wt,Zt,Jt,Kt])]),e("tbody",Qt,[(i(!0),c(C,null,$(v.value,s=>(i(),c("tr",{key:`search-${s.id}`,class:"hover:bg-gray-50 dark:hover:bg-gray-700"},[e("td",Xt,[A(e("input",{type:"checkbox",class:"form-checkbox h-4 w-4 text-blue-500 dark:text-blue-400 rounded dark:bg-gray-700 dark:border-gray-600","onUpdate:modelValue":r[15]||(r[15]=u=>f.value=u),value:s.id},null,8,es),[[de,f.value]])]),e("td",ts,n(s.student_id),1),e("td",{class:"px-4 py-3 text-sm text-gray-900 dark:text-gray-300 max-w-[200px] truncate",title:`${s.last_name}, ${s.first_name} ${s.middle_name}`},n(s.last_name)+", "+n(s.first_name)+" "+n(s.middle_name),9,ss),e("td",rs,n(s.course?s.course.code:""),1),e("td",os,[e("span",{class:_(["px-2 inline-flex text-xs leading-5 font-semibold rounded-full",z(h.value==="nstp1"?s.first_sem_status:s.second_sem_status)])},n(V(h.value==="nstp1"?s.first_sem_status:s.second_sem_status)),3)])]))),128)),v.value.length===0?(i(),c("tr",as,[e("td",ns,n(b(d).search||b(d).course_id||b(d).school_year?"No pending students found matching your search criteria. Only students with PENDING status are shown.":"Enter search criteria to find students. Only students with PENDING status can be marked as failed."),1)])):y("",!0)])])]),e("div",ds,[e("button",{onClick:r[16]||(r[16]=s=>w.value=!1),class:"py-2 px-4 bg-gray-500 hover:bg-gray-700 text-white rounded text-sm"}," Cancel "),e("button",{onClick:W,class:_(["py-2 px-4 bg-blue-500 hover:bg-blue-700 text-white rounded text-sm",{"opacity-50 cursor-not-allowed":f.value.length===0}]),disabled:f.value.length===0}," Add "+n(f.value.length)+" Selected Students ",11,ls)])])]),is])):y("",!0),S.value?(i(),c("div",cs,[e("div",us,[e("div",gs,[e("div",ps,[e("h2",hs," Students Selected to Fail (NSTP "+n(h.value==="nstp1"?"1":"2")+") ",1),e("button",{onClick:r[17]||(r[17]=s=>S.value=!1),class:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 focus:outline-none"},xs)]),e("div",fs,[e("table",bs,[_s,e("tbody",ys,[(i(!0),c(C,null,$(I(),s=>(i(),c("tr",{key:`selected-${s.id}`,class:"hover:bg-gray-50 dark:hover:bg-gray-700"},[e("td",vs,n(s.student_id),1),e("td",{class:"px-4 py-3 text-sm text-gray-900 dark:text-gray-300 max-w-[200px] truncate",title:`${s.last_name}, ${s.first_name} ${s.middle_name}`},n(s.last_name)+", "+n(s.first_name)+" "+n(s.middle_name),9,ws),e("td",ks,n(s.course?s.course.code:""),1),e("td",Ss,[e("span",{class:_(["px-2 inline-flex text-xs leading-5 font-semibold rounded-full",z(h.value==="nstp1"?s.first_sem_status:s.second_sem_status)])},n(V(h.value==="nstp1"?s.first_sem_status:s.second_sem_status)),3),Cs]),e("td",Ps,[e("button",{onClick:u=>Z(s.id),class:"text-red-500 hover:text-red-700 dark:text-red-400 dark:hover:text-red-300 focus:outline-none"}," Remove ",8,Ns)])]))),128)),I().length===0?(i(),c("tr",Fs,As)):y("",!0)])])]),e("div",$s,[e("button",{onClick:r[18]||(r[18]=s=>S.value=!1),class:"py-2 px-4 bg-gray-500 hover:bg-gray-700 text-white rounded text-sm"}," Close ")])])]),js])):y("",!0)]),_:1})],64))}};export{Bs as default};
